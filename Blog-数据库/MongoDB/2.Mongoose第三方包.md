# Mongoose的入门
 
**这里按顺序介绍了mongoose的创建、查询、修改、查询，但是请注意，我仅仅记录了最基本的操作，为了适应各种业务场景，仍然需要我们自己的查询文档API**
[Mongoose官方文档](https://mongoosejs.com/docs/index.html)

### 下载mongoose
```shell
$ npm install mongoose
```

### 引入mongoose
```shell
var mongoose = require('mongoose');=
```
### 链接数据库
```shell
mongoose.connect('mongodb://localhost/test');
```

### Schema,我们给要给他一定的约束
```js
//2，设计文档结构
var userSchema = new Schema({
  username: {
    type: String,
    require: true //必须有
  },
  password: {
    type: String,
    require: true
  },
  email: {
    type: String
  }
});
```

### 将文档结构发布为模型
  * mongoose.model 有两个参数
  * 第一个参数； 
    + 传入一个大写名词单数字符串，同来表示你的数据库名称
    + mongoose 会自动将答谢名词的字符串生成 小写复数 的集合名称
    + 例如 User 最终会变味 users
  * 第二个参数： 架构 Schema
    + 返回模型对象
```js
var User = mongoose.model('Blog', userSchema);
```

### 当我们有了模型构造函数后，就可以使用这个函数构造对 users 进行操作
```js
var admin = new User({  
    username:'admin',
    password: '123456',
    email:'admin@admin.com'
});
```

### 但是我们还没有向MongoDB保存任何内容。可以通过调用其save方法将每个文档保存到数据库中。如果发生任何回调，则回调的第一个参数将是错误。
```js
admin.save(function (err, ret) {
  if(err){
    console.log('存储失败')
  }else {
    console.log(ret,'保存成功');
  }
});

```

### 我们创建了这个人的信息，那么入如何查看呢？
```js
User.find(function (err, ret) {
  if(err){
    cosnole.log('查询失败')
  }else{
    console.log(ret,'查询成功')
  }
});

### 注意，此时我们是将所有内容都输出了出来，但是如果我只想找`name：张三`的呢？
```js
User.find({name:"张三"},function (err, ret) {
  if(err){
    cosnole.log('查询失败')
  }else{
    console.log(ret,'查询成功')
  }
});
```

### 我循环创建了10个人，如何查一个？

```js
User.findOne({
  username: 'admin'
},function (err, ret) {
  if(err){
    cosnole.log('查询失败')
  }else{
    console.log(ret[0].email,'查询成功')
  }
});//只找一个，如果没有条件限制，就会输出第一个
```

### 最后如果你想修改某条数据怎么办？

```js
User.findByIdAndUpdate('5c7cc53c7bdde4fbc6a6a87a',{password: '654321'}, function (err, ret) {
  if(err){
    console.log('更新失败')
  }else{
    console.log(ret,'更新成功')
  }
});
```

个人认为增删改查里，“改”是最复杂的，大家按顺序过一遍上面的代码，相信会对大家认识`mongoose`起到帮助，所以我们大家共勉～


